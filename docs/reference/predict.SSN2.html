<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Predicted values and intervals based on a fitted model object."><title>Model predictions (Kriging) — predict.SSN2 • SSN2</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Model predictions (Kriging) — predict.SSN2"><meta property="og:description" content="Predicted values and intervals based on a fitted model object."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">SSN2</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/introduction.html">An Introduction to Spatial Stream Network Modeling in R Using SSN2</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/USEPA/SSN2/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Model predictions (Kriging)</h1>
      <small class="dont-index">Source: <a href="https://github.com/USEPA/SSN2/blob/HEAD/R/predict.R" class="external-link"><code>R/predict.R</code></a>, <a href="https://github.com/USEPA/SSN2/blob/HEAD/R/predict_glm.R" class="external-link"><code>R/predict_glm.R</code></a></small>
      <div class="d-none name"><code>predict.SSN2.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Predicted values and intervals based on a fitted model object.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S3 method for ssn_lm</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  <span class="va">newdata</span>,</span>
<span>  se.fit <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  interval <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"none"</span>, <span class="st">"confidence"</span>, <span class="st">"prediction"</span><span class="op">)</span>,</span>
<span>  level <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  block <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for ssn_glm</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  <span class="va">newdata</span>,</span>
<span>  type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"link"</span>, <span class="st">"response"</span><span class="op">)</span>,</span>
<span>  se.fit <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  interval <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"none"</span>, <span class="st">"confidence"</span>, <span class="st">"prediction"</span><span class="op">)</span>,</span>
<span>  <span class="va">newdata_size</span>,</span>
<span>  level <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  var_correct <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>object</dt>
<dd><p>A fitted model object from <code><a href="ssn_lm.html">ssn_lm()</a></code> or <code><a href="ssn_glm.html">ssn_glm()</a></code>.</p></dd>


<dt>newdata</dt>
<dd><p>A character vector that indicates the name of the prediction data set
in the SSN object for which predictions are desired. If omitted, predictions
for all prediction data sets are returned. Note that the name <code>".missing"</code>
indicates the prediction data set that contains the missing observations in the data used
to fit the model.</p></dd>


<dt>se.fit</dt>
<dd><p>A logical indicating if standard errors are returned.
The default is <code>FALSE</code>.</p></dd>


<dt>interval</dt>
<dd><p>Type of interval calculation. The default is <code>"none"</code>.
Other options are <code>"confidence"</code> (for confidence intervals) and
<code>"prediction"</code> (for prediction intervals).</p></dd>


<dt>level</dt>
<dd><p>Tolerance/confidence level. The default is <code>0.95</code>.</p></dd>


<dt>block</dt>
<dd><p>A logical indicating whether a block prediction over the entire
region in <code>newdata</code> should be returned. The default is <code>FALSE</code>, which returns point
predictions for each location in <code>newdata</code>. Currently only available for
model fit using <code><a href="ssn_lm.html">ssn_lm()</a></code> or models fit using <code><a href="ssn_glm.html">ssn_glm()</a></code> where
<code>family</code> is <code>"gaussian"</code>.</p></dd>


<dt>...</dt>
<dd><p>Other arguments. Not used (needed for generic consistency).</p></dd>


<dt>type</dt>
<dd><p>The scale (<code>response</code> or <code>link</code>) of predictions obtained
using <code>ssn_glm</code> objects.</p></dd>


<dt>newdata_size</dt>
<dd><p>The <code>size</code> value for each observation in <code>newdata</code>
used when predicting for the binomial family.</p></dd>


<dt>var_correct</dt>
<dd><p>A logical indicating whether to return the corrected prediction
variances when predicting via models fit using <code>ssn_glm</code>. The default is
<code>TRUE</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>If <code>se.fit</code> is <code>FALSE</code>, <code>predict.ssn()</code> returns
a vector of predictions or a matrix of predictions with column names
<code>fit</code>, <code>lwr</code>, and <code>upr</code> if <code>interval</code> is <code>"confidence"</code></p>


<p>or <code>"prediction"</code>. If <code>se.fit</code> is <code>TRUE</code>, a list with the following components is returned:</p><ul><li><p><code>fit</code>: vector or matrix as above</p></li>
<li><p><code>se.fit:</code> standard error of each fit</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The (empirical) best linear unbiased predictions (i.e., Kriging
predictions) at each site are returned when <code>interval</code> is <code>"none"</code>
or <code>"prediction"</code> alongside standard errors. Prediction intervals
are also returned if <code>interval</code> is <code>"prediction"</code>. When
<code>interval</code> is <code>"confidence"</code>, the estimated mean is returned
alongside standard errors and confidence intervals for the mean.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Copy the mf04p .ssn data to a local directory and read it into R</span></span></span>
<span class="r-in"><span><span class="co"># When modeling with your .ssn object, you will load it using the relevant</span></span></span>
<span class="r-in"><span><span class="co"># path to the .ssn data on your machine</span></span></span>
<span class="r-in"><span><span class="fu"><a href="copy_lsn_to_temp.html">copy_lsn_to_temp</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">temp_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"/MiddleFork04.ssn"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mf04p</span> <span class="op">&lt;-</span> <span class="fu"><a href="ssn_import.html">ssn_import</a></span><span class="op">(</span><span class="va">temp_path</span>, predpts <span class="op">=</span> <span class="st">"pred1km"</span>, overwrite <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">ssn_mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="ssn_lm.html">ssn_lm</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  formula <span class="op">=</span> <span class="va">Summer_mn</span> <span class="op">~</span> <span class="va">ELEV_DEM</span>,</span></span>
<span class="r-in"><span>  ssn.object <span class="op">=</span> <span class="va">mf04p</span>,</span></span>
<span class="r-in"><span>  tailup_type <span class="op">=</span> <span class="st">"exponential"</span>,</span></span>
<span class="r-in"><span>  additive <span class="op">=</span> <span class="st">"afvArea"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">ssn_mod</span>, <span class="st">"pred1km"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          1          2          3          4          5          6          7 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14.6443346 15.0150979 14.7513549 14.9717229 15.1513874 15.1159790 15.1069520 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          8          9         10         11         12         13         14 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14.9863186 14.9038332 14.8702627 14.7308979 14.6992062 14.7579446 14.8764063 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         15         16         17         18         19         20         21 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14.3287719 14.4149823 14.0532325 13.9397314 10.9750633 13.1067606 13.6244111 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         22         23         24         25         26         27         28 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10.0996588  5.6054226  8.1409677 12.9269053 13.5019980 11.3419554 11.9747664 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         29         30         31         32         33         34         35 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11.2154309 10.2149138 10.4816809 10.7348106  9.7103402 11.3759625 12.2120558 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         36         37         38         39         40         41         42 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12.9616826 12.5664805 12.3028149 13.8079249 13.5395082 12.9715817 13.2152150 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         43         44         45         46         47         48         49 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12.3273384 12.5850380 10.7406072 10.9713095 11.2308341  8.6629974  9.3260313 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         50         51         52         53         54         55         56 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10.2772878 12.1296929 11.7154947 11.1310275 11.5790357 11.7855844 12.0521877 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         57         58         59         60         61         62         63 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11.2655590  9.7898915  8.0483307  8.7966695  9.1037886  8.5118636 11.4956913 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         64         65         66         67         68         69         70 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11.9862160 11.6161901 12.6246359 12.4406987 10.6278901 11.1747555 11.6063313 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         71         72         73         74         75         76         77 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13.9269581 14.4813989 14.5959969 10.1604842 12.4655751 13.8195311 10.1977736 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         78         79         80         81         82         83         84 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14.5789082 15.4149064 15.5879931 13.6734603 14.5383442 15.1150059 15.3746230 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         85         86         87         88         89         90         91 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10.0788306  7.9453413  8.7202052  7.5438136 11.1468478  9.4793850 10.2847461 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         92         93         94         95         96         97         98 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1.5531965  5.4715321  7.2281978  8.6101730  5.0354923 11.3558953 11.7586313 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         99        100        101        102        103        104        105 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12.2766556 12.5929234  9.8923651  9.3683314  6.6259182 12.7363403  4.3346894 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        106        107        108        109        110        111        112 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  3.8724173  3.5215224  7.0452774  8.3977344  7.1561650 -1.1426926  1.4202968 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        113        114        115        116        117        118        119 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  4.0985733  6.4886255  7.8698972  7.5852381  9.9485049  3.7673801  5.5245583 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        120        121        122        123        124        125        126 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  8.5264446 15.2798374 14.2197123  9.2990140 11.5461684 15.5970950 14.1134907 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        127        128        129        130        131        132        133 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15.2664073  6.0647130  8.3993355 10.3304465  8.0105836 10.6329256 12.2753107 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        134        135        136        137        138        139        140 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12.3778096 14.7132922 16.0976413 14.2078071  9.4203169 12.1022897  5.5831669 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        141        142        143        144        145        146        147 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  8.6941805 11.3728589  9.3402885 11.3857715 15.1158602 15.2888149 11.5265537 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        148        149        150        151        152        153        154 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12.5079422 10.3691975 -0.6748125  2.9279685  6.7325051  9.3265074 12.2087322 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        155        156        157        158        159        160        161 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14.2262895  7.5221930 10.5192746 12.5652217  6.8460851 12.3513293  1.0470183 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        162        163        164        165        166        167        168 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12.9732758  8.9524078 11.7760066 11.4752712  7.9069483 11.0199167 11.3624102 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        169        170        171        172        173        174        175 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11.8228944 11.9951556 12.2250606  8.7431663  9.2898993  2.3113801  6.7492847 </span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Michael Dumelle, Jay M. Ver Hoef, Erin Peterson.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

